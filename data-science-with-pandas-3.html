<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Python &amp; Data - 8&nbsp; Combining DataFrames</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-science-with-pandas-4.html" rel="next">
<link href="./data-science-with-pandas-2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-science-with-pandas-1.html">Working With Data</a></li><li class="breadcrumb-item"><a href="./data-science-with-pandas-3.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Combining DataFrames</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/python-hex-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Python &amp; Data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/UtrechtUniversity/workshop-introduction-to-python" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installation-and-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation &amp; Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./course-materials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop Materials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Python Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables and printing output</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Operators and built-in functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data types, if-statements and for-loops</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Write your own Python function</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Working With Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reading and Exploring data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping, Indexing, Slicing, and Subsetting DataFrames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Combining DataFrames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What Next?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#concatenating-dataframes" id="toc-concatenating-dataframes" class="nav-link active" data-scroll-target="#concatenating-dataframes"><span class="header-section-number">8.1</span> Concatenating DataFrames</a>
  <ul class="collapse">
  <li><a href="#vertical-concatenation" id="toc-vertical-concatenation" class="nav-link" data-scroll-target="#vertical-concatenation"><span class="header-section-number">8.1.1</span> Vertical concatenation</a></li>
  <li><a href="#horizontal-concatenation" id="toc-horizontal-concatenation" class="nav-link" data-scroll-target="#horizontal-concatenation"><span class="header-section-number">8.1.2</span> Horizontal concatenation</a></li>
  </ul></li>
  <li><a href="#joining-dataframes" id="toc-joining-dataframes" class="nav-link" data-scroll-target="#joining-dataframes"><span class="header-section-number">8.2</span> Joining DataFrames</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/UtrechtUniversity/workshop-introduction-to-python/blob/main/data-science-with-pandas-3.ipynb" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Combining DataFrames</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Previously, we have seen how to analyze and manipulate data in a single DataFrame. However, you will often find data saved into different files and, therefore, you may need to deal with several different pandas DataFrames.<br> In this session we will explore different ways of combining DataFrames into a single DataFrame.</p>
<p>Let’s start loading the <code>pandas</code> library, reading two data sets into DataFrames, and having a quick look at the tabular data: <code>surveys.csv</code> and <code>species.csv</code></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"../course_materials/data/surveys.csv"</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>species_df <span class="op">=</span> pd.read_csv(<span class="st">"../course_materials/data/species.csv"</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(surveys_df.info())</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>surveys_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 35549 entries, 0 to 35548
Data columns (total 9 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   record_id        35549 non-null  int64  
 1   month            35549 non-null  int64  
 2   day              35549 non-null  int64  
 3   year             35549 non-null  int64  
 4   plot_id          35549 non-null  int64  
 5   species_id       34786 non-null  object 
 6   sex              33038 non-null  object 
 7   hindfoot_length  31438 non-null  float64
 8   weight           32283 non-null  float64
dtypes: float64(2), int64(5), object(2)
memory usage: 2.4+ MB
None</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>7</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(species_df.info())</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>species_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 54 entries, 0 to 53
Data columns (total 4 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   species_id  54 non-null     object
 1   genus       54 non-null     object
 2   species     54 non-null     object
 3   taxa        54 non-null     object
dtypes: object(4)
memory usage: 1.8+ KB
None</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">genus</th>
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th">taxa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>AB</td>
<td>Amphispiza</td>
<td>bilineata</td>
<td>Bird</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>AH</td>
<td>Ammospermophilus</td>
<td>harrisi</td>
<td>Rodent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>AS</td>
<td>Ammodramus</td>
<td>savannarum</td>
<td>Bird</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>BA</td>
<td>Baiomys</td>
<td>taylori</td>
<td>Rodent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CB</td>
<td>Campylorhynchus</td>
<td>brunneicapillus</td>
<td>Bird</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We now have two DataFrames. The first, <code>surveys_df</code>, contains information on individuals of a species recorded in a survey, while the second, <code>species_df</code>, contains more detailed information on each species.</p>
<section id="concatenating-dataframes" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="concatenating-dataframes"><span class="header-section-number">8.1</span> Concatenating DataFrames</h2>
<p>The first way we will combine DataFrames is <strong>concatenation</strong>, i.e.&nbsp;simply putting DataFrames one after the other either <strong>verically</strong> or <strong>horizontally</strong>.</p>
<p>Concatenation can be used if the DataFrames are similar, meaning that they either have the same rows or columns. We will see examples of this later.</p>
<p>To concatenate two DataFrames you will use the function <code>pd.concat()</code>, specifying as arguments the DataFrames to concatenate and <code>axis=0</code> or <code>axis=1</code> for vertical or horizontal concatenation, respectively.</p>
<p>Let us first obtain two small DataFrames from the larger <code>surveys.csv</code> dataset.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting DataFrames</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>surveys_df_sub_first10 <span class="op">=</span> surveys_df.head(<span class="dv">10</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>surveys_df_sub_last10  <span class="op">=</span> surveys_df.tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now have two DataFrames, one with the first ten rows of the original dataset, and another with the last ten rows.</p>
<section id="vertical-concatenation" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="vertical-concatenation"><span class="header-section-number">8.1.1</span> Vertical concatenation</h3>
Let’s start with <strong>vertical stacking</strong>. In this case the two DataFrames are simply stacked ‘on top of’ eachother (remember to specify <code>axis=0</code>).
<div>
<p><img src="images/vertical_stacking.jpeg" width="300"></p>
</div>
<p>Vertical stacking can be understood as combining two DataFrames that have different sets of the same type of data. In our example, it may be that one field researcher has registered the first ten entries, and another did the last ten, both using the same laboratory sheets. They both wrote down the same information (weight, species, and so on) of all different individuals. If we combine them, we have one list of twenty records, rather than two lists of ten.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack the DataFrames on top of each other</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>vertical_stack <span class="op">=</span> pd.concat([surveys_df_sub_first10, surveys_df_sub_last10], axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vertical_stack.info())</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>vertical_stack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 20 entries, 0 to 35548
Data columns (total 9 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   record_id        20 non-null     int64  
 1   month            20 non-null     int64  
 2   day              20 non-null     int64  
 3   year             20 non-null     int64  
 4   plot_id          20 non-null     int64  
 5   species_id       19 non-null     object 
 6   sex              16 non-null     object 
 7   hindfoot_length  15 non-null     float64
 8   weight           6 non-null      float64
dtypes: float64(2), int64(5), object(2)
memory usage: 1.6+ KB
None</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>7</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>PF</td>
<td>M</td>
<td>14.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>PE</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>DM</td>
<td>M</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>DM</td>
<td>F</td>
<td>34.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>6</td>
<td>PF</td>
<td>F</td>
<td>20.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35539</td>
<td>35540</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35540</td>
<td>35541</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>24.0</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35541</td>
<td>35542</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35542</td>
<td>35543</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>27.0</td>
<td>34.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35543</td>
<td>35544</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>US</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35544</td>
<td>35545</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35545</td>
<td>35546</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35546</td>
<td>35547</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>10</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35547</td>
<td>35548</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>7</td>
<td>DO</td>
<td>M</td>
<td>36.0</td>
<td>51.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35548</td>
<td>35549</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The resulting DataFrame (<code>vertical_stack</code>) consists, as expected, of 20 rows. These are the result of the first and last 10 rows of our original DataFrame <code>surveys_df</code>.</p>
<p>You may have noticed that the last ten rows have very high index, not consecutive with the first ten rows. This is because concatenation preserves the indices of the two original DataFrames. If you want a brand new set of indices for your concateneted DataFrame, simply reset the indices using the method <code>.reset_index()</code>. Notice that this adds a column <code>index</code> to your DataFrame, that maintains the original index. If you pass <code>drop=True</code> into the function, you will avoid the addition of this column.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>vertical_stack.reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>7</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>PF</td>
<td>M</td>
<td>14.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>6</td>
<td>7</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>PE</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>8</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>DM</td>
<td>M</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>8</td>
<td>9</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>DM</td>
<td>F</td>
<td>34.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>9</td>
<td>10</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>6</td>
<td>PF</td>
<td>F</td>
<td>20.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>35539</td>
<td>35540</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>35540</td>
<td>35541</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>24.0</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>35541</td>
<td>35542</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>35542</td>
<td>35543</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>27.0</td>
<td>34.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>35543</td>
<td>35544</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>US</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>35544</td>
<td>35545</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>35545</td>
<td>35546</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>35546</td>
<td>35547</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>10</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>35547</td>
<td>35548</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>7</td>
<td>DO</td>
<td>M</td>
<td>36.0</td>
<td>51.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>35548</td>
<td>35549</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="alert alert-block alert-success">
<p><b>Exercise 11</b></p>
<p>Now go to the Jupyter Dashboard in your internet browser and continue with exercise 11.</p>
</div></section>
<section id="horizontal-concatenation" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="horizontal-concatenation"><span class="header-section-number">8.1.2</span> Horizontal concatenation</h3>
It’s now time to try <strong>horizontal stacking</strong>. In this case the two DataFrames are simply put one after the other (remember to specify <code>axis=1</code>).
<div>
<p><img src="images/horizontal_stacking.jpeg" width="300"></p>
</div>
<p>Horizontal stacking can be understood as combining two DataFrames that have different measurements on the same observed objects. In our example, it may be that one field researcher has registered the weight and hindfoot length of an individual, and another wrote down their species and sex. They both registered different information of the same individuals. If we combine them, we have one list with all the information of the individual, rather than two lists with partial information.</p>
<p>We now go back to our DataFrames with 10 survey result each, and concatenate those. In this case, as a result, we would expect a DataFrame with the same number of rows of the original ones (10 row) and twice the number of columns (18 columns).</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Place the DataFrames side by side</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([surveys_df_sub_first10, surveys_df_sub_last10], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(horizontal_stack.info())</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>horizontal_stack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 20 entries, 0 to 35548
Data columns (total 18 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   record_id        10 non-null     float64
 1   month            10 non-null     float64
 2   day              10 non-null     float64
 3   year             10 non-null     float64
 4   plot_id          10 non-null     float64
 5   species_id       10 non-null     object 
 6   sex              10 non-null     object 
 7   hindfoot_length  9 non-null      float64
 8   weight           0 non-null      float64
 9   record_id        10 non-null     float64
 10  month            10 non-null     float64
 11  day              10 non-null     float64
 12  year             10 non-null     float64
 13  plot_id          10 non-null     float64
 14  species_id       9 non-null      object 
 15  sex              6 non-null      object 
 16  hindfoot_length  6 non-null      float64
 17  weight           6 non-null      float64
dtypes: float64(14), object(4)
memory usage: 3.0+ KB
None</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>2.0</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>3.0</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>2.0</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>7.0</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>3.0</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>1.0</td>
<td>PF</td>
<td>M</td>
<td>14.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>2.0</td>
<td>PE</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>1.0</td>
<td>DM</td>
<td>M</td>
<td>37.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>1.0</td>
<td>DM</td>
<td>F</td>
<td>34.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10.0</td>
<td>7.0</td>
<td>16.0</td>
<td>1977.0</td>
<td>6.0</td>
<td>PF</td>
<td>F</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35539</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35540.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35540</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35541.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>PB</td>
<td>F</td>
<td>24.0</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35541</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35542.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35542</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35543.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>PB</td>
<td>F</td>
<td>27.0</td>
<td>34.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35543</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35544.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>US</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35544</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35545.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35545</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35546.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>15.0</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35546</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35547.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>10.0</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35547</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35548.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>7.0</td>
<td>DO</td>
<td>M</td>
<td>36.0</td>
<td>51.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35548</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35549.0</td>
<td>12.0</td>
<td>31.0</td>
<td>2002.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Looking at the result of our horizontal concatenation, we may realise that something went wrong. The total number of rows on the resulting DataFrame is 20, instead of 10.</p>
<p>This happens because horizontal stacking will only merge rows that actually “belong together”. Rows that relate to the same observed object are merged. To determine this, it compares the indices of the rows. In our two DataFrames, the rows have different indices (1-9 and 35539-35548 respectively). It will therefore not merge any of the rows together, as it does not find any two rows that relate to the same observation.</p>
<p>If we want to force the DataFrames into the form we had in mind, we need to reset the indices of the second DataFrame so that they will match the ones of the first DataFrame.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>surveys_df_sub_last10 <span class="op">=</span> surveys_df_sub_last10.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>surveys_df_sub_last10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>35540</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>35541</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>24.0</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>35542</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>35543</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>27.0</td>
<td>34.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>35544</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>US</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>35545</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>35546</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>35547</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>10</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>35548</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>7</td>
<td>DO</td>
<td>M</td>
<td>36.0</td>
<td>51.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>35549</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now that the index has been reset, we can concatenate the two DataFrames.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([surveys_df_sub_first10, surveys_df_sub_last10], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(horizontal_stack.info())</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>horizontal_stack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10 entries, 0 to 9
Data columns (total 18 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   record_id        10 non-null     int64  
 1   month            10 non-null     int64  
 2   day              10 non-null     int64  
 3   year             10 non-null     int64  
 4   plot_id          10 non-null     int64  
 5   species_id       10 non-null     object 
 6   sex              10 non-null     object 
 7   hindfoot_length  9 non-null      float64
 8   weight           0 non-null      float64
 9   record_id        10 non-null     int64  
 10  month            10 non-null     int64  
 11  day              10 non-null     int64  
 12  year             10 non-null     int64  
 13  plot_id          10 non-null     int64  
 14  species_id       9 non-null      object 
 15  sex              6 non-null      object 
 16  hindfoot_length  6 non-null      float64
 17  weight           6 non-null      float64
dtypes: float64(4), int64(10), object(4)
memory usage: 1.5+ KB
None</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
<td>35540</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
<td>35541</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>24.0</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
<td>35542</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>7</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
<td>35543</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>27.0</td>
<td>34.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
<td>35544</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>US</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>PF</td>
<td>M</td>
<td>14.0</td>
<td>NaN</td>
<td>35545</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>PE</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>35546</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>DM</td>
<td>M</td>
<td>37.0</td>
<td>NaN</td>
<td>35547</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>10</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>1</td>
<td>DM</td>
<td>F</td>
<td>34.0</td>
<td>NaN</td>
<td>35548</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>7</td>
<td>DO</td>
<td>M</td>
<td>36.0</td>
<td>51.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>6</td>
<td>PF</td>
<td>F</td>
<td>20.0</td>
<td>NaN</td>
<td>35549</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="alert alert-block alert-success">
<p><b>Exercise 12</b></p>
<p>Now go to the Jupyter Dashboard in your internet browser and continue with exercise 12.</p>
</div></section>
</section>
<section id="joining-dataframes" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="joining-dataframes"><span class="header-section-number">8.2</span> Joining DataFrames</h2>
<p>Concatenating DataFrames allows you to combine two entire DataFrames into a single one. In many cases, you want to combine only selected parts of two DataFrames.</p>
<p>You might, for example, want to merge rows of two DataFrames that have matching values in specific columns. The pandas function <code>merge()</code> performs an operation that you may know as a <em>join</em> if you worked with databases before. The join operation joins the content of two DataFrames in a particular way. There are different types of joins, but the workflow to perform a join operation is always the same:</p>
<ol type="1">
<li>You identify a <em>left</em> and a <em>right</em> DataFrame, among the two you want to join;</li>
<li>You identify in both your left and right DataFrame a column (or set of columns) to join on;</li>
<li>You choose the type of join;</li>
<li>You perform the join running the function <code>pd.merge()</code> with the specified inputs and options.</li>
</ol>
<p>What it means for a DataFrame to be ‘left’ or ‘right’ depends on the type of join, and will become clear in the examples below. For now, just remember that it matters which DataFrame you mention first when performing a join.</p>
<p>Let’s see some join example considering two tiny (few rows) DataFrames. Our left DataFrame contains general data of European capitals, and our right DataFrame contains weather measurements for some Dutch towns. We first need to import these datasets:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>left_df <span class="op">=</span> pd.read_csv(<span class="st">"../course_materials/data/EU_capitals_tiny.csv"</span>, sep<span class="op">=</span><span class="st">","</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>right_df <span class="op">=</span> pd.read_csv(<span class="st">"../course_materials/data/Netherlands_town_weather_tiny.csv"</span>, sep<span class="op">=</span><span class="st">","</span>, header<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>left_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Time_zone</th>
<th data-quarto-table-cell-role="th">Elevation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Amsterdam</td>
<td>The Netherland</td>
<td>2480394</td>
<td>UTC+1</td>
<td>-2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Rome</td>
<td>Italy</td>
<td>1459402</td>
<td>UTC+1</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Paris</td>
<td>France</td>
<td>10858852</td>
<td>UTC+1</td>
<td>131</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Madrid</td>
<td>Spain</td>
<td>6791667</td>
<td>UTC+1</td>
<td>650</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Berlin</td>
<td>Germany</td>
<td>4473101</td>
<td>UTC+1</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Lisbon</td>
<td>Portugal</td>
<td>2719000</td>
<td>UTC+1</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>right_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Town</th>
<th data-quarto-table-cell-role="th">Elevation</th>
<th data-quarto-table-cell-role="th">Temperature</th>
<th data-quarto-table-cell-role="th">Humidity</th>
<th data-quarto-table-cell-role="th">Wind dir</th>
<th data-quarto-table-cell-role="th">Wind strengh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Amsterdam</td>
<td>2</td>
<td>12</td>
<td>81</td>
<td>SW</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Arnhem</td>
<td>13</td>
<td>12</td>
<td>82</td>
<td>S</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Utrecht</td>
<td>5</td>
<td>13</td>
<td>78</td>
<td>S</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Rotterdam</td>
<td>0</td>
<td>13</td>
<td>84</td>
<td>SW</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Leiden</td>
<td>0</td>
<td>12</td>
<td>89</td>
<td>SW</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Den Haag</td>
<td>1</td>
<td>12</td>
<td>85</td>
<td>SW</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Rotterdam</td>
<td>0</td>
<td>13</td>
<td>84</td>
<td>SW</td>
<td>16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The column we want to perform the join on is the one containing information about the town. In the left DataFrame this has name <em>Capital</em> while in the right one <em>Town</em>.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>inner_join <span class="op">=</span> pd.merge(left_df,right_df,left_on<span class="op">=</span><span class="st">'Capital'</span>,right_on<span class="op">=</span><span class="st">'Town'</span>,how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>inner_join</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Time_zone</th>
<th data-quarto-table-cell-role="th">Elevation_x</th>
<th data-quarto-table-cell-role="th">Town</th>
<th data-quarto-table-cell-role="th">Elevation_y</th>
<th data-quarto-table-cell-role="th">Temperature</th>
<th data-quarto-table-cell-role="th">Humidity</th>
<th data-quarto-table-cell-role="th">Wind dir</th>
<th data-quarto-table-cell-role="th">Wind strengh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Amsterdam</td>
<td>The Netherland</td>
<td>2480394</td>
<td>UTC+1</td>
<td>-2</td>
<td>Amsterdam</td>
<td>2</td>
<td>12</td>
<td>81</td>
<td>SW</td>
<td>21</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you may notice, the resulting DataFrame has only one line, the only row that the columns <em>Capital</em> and <em>Town</em> have in common (<em>Amsterdam</em>). This is because an inner join selects only those row values that are <strong>the same</strong> in the two columns (mathematically, an intersection).</p>
<p>The columns of the two DataFrames are all preserved, even if they have the same name. In our case, both left and right DataFrames have a column with the same name (<em>Elevation</em>). After merging, the two columns are preserved, but with a suffix to distinguish them. If you are not happy with the default suffix, you may specify yours in the list of arguments of the <code>pd.merge</code> functions.</p>
<p>Let’s now look at the other joins:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>left_join <span class="op">=</span> pd.merge(left_df,right_df,left_on<span class="op">=</span><span class="st">'Capital'</span>,right_on<span class="op">=</span><span class="st">'Town'</span>,how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>left_join</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Time_zone</th>
<th data-quarto-table-cell-role="th">Elevation_x</th>
<th data-quarto-table-cell-role="th">Town</th>
<th data-quarto-table-cell-role="th">Elevation_y</th>
<th data-quarto-table-cell-role="th">Temperature</th>
<th data-quarto-table-cell-role="th">Humidity</th>
<th data-quarto-table-cell-role="th">Wind dir</th>
<th data-quarto-table-cell-role="th">Wind strengh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Amsterdam</td>
<td>The Netherland</td>
<td>2480394</td>
<td>UTC+1</td>
<td>-2</td>
<td>Amsterdam</td>
<td>2.0</td>
<td>12.0</td>
<td>81.0</td>
<td>SW</td>
<td>21.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Rome</td>
<td>Italy</td>
<td>1459402</td>
<td>UTC+1</td>
<td>21</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Paris</td>
<td>France</td>
<td>10858852</td>
<td>UTC+1</td>
<td>131</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Madrid</td>
<td>Spain</td>
<td>6791667</td>
<td>UTC+1</td>
<td>650</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Berlin</td>
<td>Germany</td>
<td>4473101</td>
<td>UTC+1</td>
<td>34</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Lisbon</td>
<td>Portugal</td>
<td>2719000</td>
<td>UTC+1</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>right_join <span class="op">=</span> pd.merge(left_df,right_df,left_on<span class="op">=</span><span class="st">'Capital'</span>,right_on<span class="op">=</span><span class="st">'Town'</span>,how<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>right_join</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Time_zone</th>
<th data-quarto-table-cell-role="th">Elevation_x</th>
<th data-quarto-table-cell-role="th">Town</th>
<th data-quarto-table-cell-role="th">Elevation_y</th>
<th data-quarto-table-cell-role="th">Temperature</th>
<th data-quarto-table-cell-role="th">Humidity</th>
<th data-quarto-table-cell-role="th">Wind dir</th>
<th data-quarto-table-cell-role="th">Wind strengh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Amsterdam</td>
<td>The Netherland</td>
<td>2480394.0</td>
<td>UTC+1</td>
<td>-2.0</td>
<td>Amsterdam</td>
<td>2</td>
<td>12</td>
<td>81</td>
<td>SW</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Arnhem</td>
<td>13</td>
<td>12</td>
<td>82</td>
<td>S</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Utrecht</td>
<td>5</td>
<td>13</td>
<td>78</td>
<td>S</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Rotterdam</td>
<td>0</td>
<td>13</td>
<td>84</td>
<td>SW</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Leiden</td>
<td>0</td>
<td>12</td>
<td>89</td>
<td>SW</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Den Haag</td>
<td>1</td>
<td>12</td>
<td>85</td>
<td>SW</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Rotterdam</td>
<td>0</td>
<td>13</td>
<td>84</td>
<td>SW</td>
<td>16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>outer_join <span class="op">=</span> pd.merge(left_df,right_df,left_on<span class="op">=</span><span class="st">'Capital'</span>,right_on<span class="op">=</span><span class="st">'Town'</span>,how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>outer_join</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Time_zone</th>
<th data-quarto-table-cell-role="th">Elevation_x</th>
<th data-quarto-table-cell-role="th">Town</th>
<th data-quarto-table-cell-role="th">Elevation_y</th>
<th data-quarto-table-cell-role="th">Temperature</th>
<th data-quarto-table-cell-role="th">Humidity</th>
<th data-quarto-table-cell-role="th">Wind dir</th>
<th data-quarto-table-cell-role="th">Wind strengh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Amsterdam</td>
<td>The Netherland</td>
<td>2480394.0</td>
<td>UTC+1</td>
<td>-2.0</td>
<td>Amsterdam</td>
<td>2.0</td>
<td>12.0</td>
<td>81.0</td>
<td>SW</td>
<td>21.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Rome</td>
<td>Italy</td>
<td>1459402.0</td>
<td>UTC+1</td>
<td>21.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Paris</td>
<td>France</td>
<td>10858852.0</td>
<td>UTC+1</td>
<td>131.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Madrid</td>
<td>Spain</td>
<td>6791667.0</td>
<td>UTC+1</td>
<td>650.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Berlin</td>
<td>Germany</td>
<td>4473101.0</td>
<td>UTC+1</td>
<td>34.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Lisbon</td>
<td>Portugal</td>
<td>2719000.0</td>
<td>UTC+1</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Arnhem</td>
<td>13.0</td>
<td>12.0</td>
<td>82.0</td>
<td>S</td>
<td>6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Utrecht</td>
<td>5.0</td>
<td>13.0</td>
<td>78.0</td>
<td>S</td>
<td>18.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Rotterdam</td>
<td>0.0</td>
<td>13.0</td>
<td>84.0</td>
<td>SW</td>
<td>13.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Rotterdam</td>
<td>0.0</td>
<td>13.0</td>
<td>84.0</td>
<td>SW</td>
<td>16.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Leiden</td>
<td>0.0</td>
<td>12.0</td>
<td>89.0</td>
<td>SW</td>
<td>19.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Den Haag</td>
<td>1.0</td>
<td>12.0</td>
<td>85.0</td>
<td>SW</td>
<td>19.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>To resume: a join always merges rows that have matching values in the columns that you merge on. Which rows you find in the resulting DataFrame, depends on the type of join: - An inner join selects only the rows that result from the combination of matching rows in both the original left and right DataFrames (intersection); - A left join selects all rows that were in the original left DataFrame, some of which may have been joined with a matching entry from the right DataFrame; - A right join selects all rows that were in the original right DataFrame, some of which may have been joined with a matching entry from the left DataFrame; - An outer join merges the two DataFrames and keeps all resulting rows.</p>
<p>To better understand how join works, it may be useful to look at the diagrams below:</p>
<div>
<p><img src="images/joins.jpeg" width="600"></p>
</div>
<ul>
<li>Do you want to select only <strong>common</strong> information between the two DataFrames? Then you use an <strong>inner join</strong>;</li>
<li>Do you want to <strong>add information</strong> to your <strong>left</strong> DataFrame? Then you use a <strong>left join</strong>;</li>
<li>Do you want to <strong>add information</strong> to your <strong>right</strong> DataFrame? Then you use a <strong>right join</strong>;</li>
<li>Do you want to get <strong>all the information</strong> from the two DataFrames? Then you use an <strong>outer join</strong>.</li>
</ul>
<p>We will continue with <a href="./data-science-with-pandas-4.html">Data visualization</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data-science-with-pandas-2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping, Indexing, Slicing, and Subsetting DataFrames</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data-science-with-pandas-4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>