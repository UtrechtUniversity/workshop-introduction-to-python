<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Python &amp; Data - 7&nbsp; Grouping, Indexing, Slicing, and Subsetting DataFrames</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-science-with-pandas-3.html" rel="next">
<link href="./data-science-with-pandas-1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-science-with-pandas-1.html">Working with data</a></li><li class="breadcrumb-item"><a href="./data-science-with-pandas-2.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping, Indexing, Slicing, and Subsetting DataFrames</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/python-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Python &amp; Data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/UtrechtUniversity/workshop-introduction-to-python" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installation-and-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Installation &amp; Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./course-materials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop Materials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Python fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables and printing output</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Operators and built-in functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data types, if-statements and for-loops</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction_to_python_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Write your own Python function</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Working with data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reading and Exploring data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping, Indexing, Slicing, and Subsetting DataFrames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Combining DataFrames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-science-with-pandas-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What Next?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#recap-load-the-data" id="toc-recap-load-the-data" class="nav-link active" data-scroll-target="#recap-load-the-data"><span class="header-section-number">7.1</span> Recap: Load the data</a></li>
  <li><a href="#selecting-data-using-column-names" id="toc-selecting-data-using-column-names" class="nav-link" data-scroll-target="#selecting-data-using-column-names"><span class="header-section-number">7.2</span> Selecting data using column names</a></li>
  <li><a href="#slicing-subsets-of-rows" id="toc-slicing-subsets-of-rows" class="nav-link" data-scroll-target="#slicing-subsets-of-rows"><span class="header-section-number">7.3</span> Slicing subsets of rows</a>
  <ul class="collapse">
  <li><a href="#interactive-part" id="toc-interactive-part" class="nav-link" data-scroll-target="#interactive-part"><span class="header-section-number">7.3.1</span> Interactive Part</a></li>
  <li><a href="#summary-selecting-slices-rows-and-columns" id="toc-summary-selecting-slices-rows-and-columns" class="nav-link" data-scroll-target="#summary-selecting-slices-rows-and-columns"><span class="header-section-number">7.3.2</span> Summary: Selecting slices, rows and columns</a></li>
  <li><a href="#subsetting-data-according-to-user-defined-criteria" id="toc-subsetting-data-according-to-user-defined-criteria" class="nav-link" data-scroll-target="#subsetting-data-according-to-user-defined-criteria"><span class="header-section-number">7.3.3</span> Subsetting Data according to user-defined criteria</a></li>
  </ul></li>
  <li><a href="#dataframe-cleaning" id="toc-dataframe-cleaning" class="nav-link" data-scroll-target="#dataframe-cleaning"><span class="header-section-number">7.4</span> DataFrame Cleaning</a></li>
  <li><a href="#grouping" id="toc-grouping" class="nav-link" data-scroll-target="#grouping"><span class="header-section-number">7.5</span> Grouping</a></li>
  <li><a href="#structure-of-a-groupby-object" id="toc-structure-of-a-groupby-object" class="nav-link" data-scroll-target="#structure-of-a-groupby-object"><span class="header-section-number">7.6</span> Structure of a groupby object</a></li>
  <li><a href="#grouping-by-multiple-columns" id="toc-grouping-by-multiple-columns" class="nav-link" data-scroll-target="#grouping-by-multiple-columns"><span class="header-section-number">7.7</span> Grouping by multiple columns</a></li>
  <li><a href="#counting-and-plotting" id="toc-counting-and-plotting" class="nav-link" data-scroll-target="#counting-and-plotting"><span class="header-section-number">7.8</span> Counting and plotting</a></li>
  <li><a href="#summary-grouping" id="toc-summary-grouping" class="nav-link" data-scroll-target="#summary-grouping"><span class="header-section-number">7.9</span> Summary grouping</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/UtrechtUniversity/workshop-introduction-to-python/blob/main/data-science-with-pandas-2.ipynb" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping, Indexing, Slicing, and Subsetting DataFrames</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="recap-load-the-data" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="recap-load-the-data"><span class="header-section-number">7.1</span> Recap: Load the data</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'../course_materials/data/surveys.csv'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>surveys_df.describe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>&lt;bound method NDFrame.describe of        record_id  month  day  year  plot_id species_id  sex  hindfoot_length  \
0              1      7   16  1977        2         NL    M             32.0   
1              2      7   16  1977        3         NL    M             33.0   
2              3      7   16  1977        2         DM    F             37.0   
3              4      7   16  1977        7         DM    M             36.0   
4              5      7   16  1977        3         DM    M             35.0   
...          ...    ...  ...   ...      ...        ...  ...              ...   
35544      35545     12   31  2002       15         AH  NaN              NaN   
35545      35546     12   31  2002       15         AH  NaN              NaN   
35546      35547     12   31  2002       10         RM    F             15.0   
35547      35548     12   31  2002        7         DO    M             36.0   
35548      35549     12   31  2002        5        NaN  NaN              NaN   

       weight  
0         NaN  
1         NaN  
2         NaN  
3         NaN  
4         NaN  
...       ...  
35544     NaN  
35545     NaN  
35546    14.0  
35547    51.0  
35548     NaN  

[35549 rows x 9 columns]&gt;</code></pre>
</div>
</div>
<p>In addition to learning about characteristics of our dataset as a whole, we may be interested in analyzing parts (subsets) of our data. For exampe we want to know how heavy our samples are:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>count    32283.000000
mean        42.672428
std         36.631259
min          4.000000
25%         20.000000
50%         37.000000
75%         48.000000
max        280.000000
Name: weight, dtype: float64</code></pre>
</div>
</div>
<p>We can also extract one specific metric if we wish:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].<span class="bu">min</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].<span class="bu">max</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].mean()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].std()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>32283</code></pre>
</div>
</div>
</section>
<section id="selecting-data-using-column-names" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="selecting-data-using-column-names"><span class="header-section-number">7.2</span> Selecting data using column names</h2>
<p>In the <a href="introduction_to_python_3.ipynb">morning session</a> we saw how to get specific values from dictionaries using keys. We can do the same with DataFrames, in fact we have already accessed the values in a column by the column name. In this section we will discover how to select values, slices of data and subsets of a DataFrame. There are two ways of selecting columns, we have already used the first:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'species_id'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0         NL
1         NL
2         DM
3         DM
4         DM
        ... 
35544     AH
35545     AH
35546     RM
35547     DO
35548    NaN
Name: species_id, Length: 35549, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>surveys_df.species_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0         NL
1         NL
2         DM
3         DM
4         DM
        ... 
35544     AH
35545     AH
35546     RM
35547     DO
35548    NaN
Name: species_id, Length: 35549, dtype: object</code></pre>
</div>
</div>
<p>How can we now create a DataFrame that only consists of the two columns <em>plot_id</em> and <em>species_id</em>?</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>surveys_df[[<span class="st">'plot_id'</span>, <span class="st">'species_id'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>NL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>NL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>DM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7</td>
<td>DM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3</td>
<td>DM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35544</td>
<td>15</td>
<td>AH</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35545</td>
<td>15</td>
<td>AH</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35546</td>
<td>10</td>
<td>RM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35547</td>
<td>7</td>
<td>DO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35548</td>
<td>5</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>35549 rows × 2 columns</p>
</div>
</div>
</div>
<p>Why the double <em>[[..]]</em>? What is the difference between <code>surveys_df['plot_id']</code> and <code>surveys_df[['plot_id']]</code>? Let us have a closer look:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(surveys_df[<span class="st">'plot_id'</span>]))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(surveys_df[[<span class="st">'plot_id'</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.series.Series'&gt;
&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
</div>
<p>The DataFrame is organised as a dictionary with the column names as keys and row numbers as keys for the values stored in a row. <code>surveys_df['plot_id']</code> will give us the value behind the key <em>plot_id</em>, in our case the series of numbers. When we ask for the values behind <em>plot_id</em> <strong>and</strong> <em>species_id</em> we need to give the DataFrame a <em>list</em> of column names like we did with <code>surveys_df[['plot_id', 'species_id']]</code>. When we pass a list of column names to a DataFrame, Pandas will execute for us the following code so that we do not have to worry about that any longer:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>col1 <span class="op">=</span> surveys_df[<span class="st">'plot_id'</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>col2 <span class="op">=</span> surveys_df[<span class="st">'species_id'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>aggregatedData <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(col1 <span class="op">=</span> col1, col2 <span class="op">=</span> col2))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>aggregatedData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">col1</th>
<th data-quarto-table-cell-role="th">col2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>NL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>NL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>DM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7</td>
<td>DM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3</td>
<td>DM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35544</td>
<td>15</td>
<td>AH</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35545</td>
<td>15</td>
<td>AH</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35546</td>
<td>10</td>
<td>RM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35547</td>
<td>7</td>
<td>DO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35548</td>
<td>5</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>35549 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="slicing-subsets-of-rows" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="slicing-subsets-of-rows"><span class="header-section-number">7.3</span> Slicing subsets of rows</h2>
<p>Slicing using the <code>[]</code> operator selects a set of rows and/or columns from a DataFrame. To slice out a set of rows, you use the following syntax: <code>data[start:stop]</code>. When slicing in pandas the start bound is included in the output. The stop bound is not included. The slicing stops <em>before</em> the stop bound. So if you want to select rows 0, 1 and 2 your code would look like this:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="dv">0</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can select specific ranges of our data in both the row and column directions using either label or integer-based indexing. The respective functions for that are called <code>loc</code> (label-based indexing) and <code>iloc</code> (integer-based indexing).</p>
<p>Let’s have a look at <code>iloc</code> first. where we use the index of a row and/or column to select it. In the example below we select the first three entries and the columns month, day and year (the second, third and fourth column, remember indexing starts at 0 on Python). The first range of numbers selects the rows, the second the columns:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iloc[row slicing, column slicing]</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>surveys_df.iloc[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can achieve the same with the function <code>loc</code>, only instead of column indices, we use the column labels this time. So, we need to know the names of the columns:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[<span class="dv">0</span>:<span class="dv">3</span>, [<span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'year'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>And there is a third way: In a forst step we select the columns by their names <code>surveys_df[['month', 'day', 'year']]</code>. From the resulting DataFrame we then, in a second step, select the first three rows <code>[0:3]</code>. Putting the two steps together, the code looks like this:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>surveys_df[[<span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'year'</span>]][<span class="dv">0</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="interactive-part" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="interactive-part"><span class="header-section-number">7.3.1</span> Interactive Part</h3>
<p>Let us further explore the <code>loc</code> and <code>iloc</code> functions as they are more powerful. Have a look at the examples below and predict their outcome before hitting enter.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all columns for rows of index values 0 and 10</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>], :]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># What does this do?</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[<span class="dv">0</span>, [<span class="st">'species_id'</span>, <span class="st">'plot_id'</span>, <span class="st">'weight'</span>]]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># What happens when you type the code below?</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>surveys_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">35549</span>], :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>KeyError: '[35549] not in index'</code></pre>
</div>
</div>
<p>We can also extract single values from our DataFrame:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data.iloc[row, column]</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>surveys_df.iloc[<span class="dv">2</span>, <span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>'F'</code></pre>
</div>
</div>
</section>
<section id="summary-selecting-slices-rows-and-columns" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="summary-selecting-slices-rows-and-columns"><span class="header-section-number">7.3.2</span> Summary: Selecting slices, rows and columns</h3>
<p>In the first two methods we extract the column specifying its name. The third method is essentially identical to the first one as the 6th (index 5) element of the Series <code>surveys_df.columns</code> is <em>species_id</em>. The fourth method uses the method <code>iloc</code> to select <em>all</em> the rows of the 6th column.</p>
<div class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By name</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Method1</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plot_id_1 <span class="op">=</span> surveys_df[<span class="st">'species_id'</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Method2</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plot_id_2 <span class="op">=</span> surveys_df.species_id</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># By location</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Method3</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plot_id_3 <span class="op">=</span> surveys_df[surveys_df.columns[<span class="dv">5</span>]]</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Method4</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plot_id_4 <span class="op">=</span> surveys_df.iloc[:,<span class="dv">5</span>]</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="alert alert-block alert-success">
<p><b>Exercise 3 to 5</b></p>
<p>Now go to the Jupyter Dashboard in your internet browser and continue with the afternoon exercises 3 to 5.</p>
</div></section>
<section id="subsetting-data-according-to-user-defined-criteria" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="subsetting-data-according-to-user-defined-criteria"><span class="header-section-number">7.3.3</span> Subsetting Data according to user-defined criteria</h3>
<p>We can extract subsets of our DataFrame following the general syntax <code>data_frame[&lt;condition_on_data&gt;]</code> <condition_on_data> is a conditional statement on the DataFrame content itself. You may think at the conditional statement as a question or query you ask to your DataFrame. Here there are some examples:</condition_on_data></p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the data collected in the year 2002?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">33320</td>
<td>33321</td>
<td>1</td>
<td>12</td>
<td>2002</td>
<td>1</td>
<td>DM</td>
<td>M</td>
<td>38.0</td>
<td>44.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33321</td>
<td>33322</td>
<td>1</td>
<td>12</td>
<td>2002</td>
<td>1</td>
<td>DO</td>
<td>M</td>
<td>37.0</td>
<td>58.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33322</td>
<td>33323</td>
<td>1</td>
<td>12</td>
<td>2002</td>
<td>1</td>
<td>PB</td>
<td>M</td>
<td>28.0</td>
<td>45.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33323</td>
<td>33324</td>
<td>1</td>
<td>12</td>
<td>2002</td>
<td>1</td>
<td>AB</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33324</td>
<td>33325</td>
<td>1</td>
<td>12</td>
<td>2002</td>
<td>1</td>
<td>DO</td>
<td>M</td>
<td>35.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35544</td>
<td>35545</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35545</td>
<td>35546</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>AH</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35546</td>
<td>35547</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>10</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35547</td>
<td>35548</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>7</td>
<td>DO</td>
<td>M</td>
<td>36.0</td>
<td>51.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35548</td>
<td>35549</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2229 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the data NOT collected in the year 2002?</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>surveys_df[surveys_df.year <span class="op">!=</span> <span class="dv">2002</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>7</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33315</td>
<td>33316</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>11</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33316</td>
<td>33317</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>13</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33317</td>
<td>33318</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>14</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33318</td>
<td>33319</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>15</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33319</td>
<td>33320</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>16</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>33320 rows × 9 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the data NOT collected in the year 2002? (different syntax)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="op">~</span>(surveys_df.year <span class="op">==</span> <span class="dv">2002</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>NL</td>
<td>M</td>
<td>32.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>NL</td>
<td>M</td>
<td>33.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>2</td>
<td>DM</td>
<td>F</td>
<td>37.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>7</td>
<td>DM</td>
<td>M</td>
<td>36.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>7</td>
<td>16</td>
<td>1977</td>
<td>3</td>
<td>DM</td>
<td>M</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33315</td>
<td>33316</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>11</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33316</td>
<td>33317</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>13</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33317</td>
<td>33318</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>14</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33318</td>
<td>33319</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>15</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33319</td>
<td>33320</td>
<td>12</td>
<td>16</td>
<td>2001</td>
<td>16</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>33320 rows × 9 columns</p>
</div>
</div>
</div>
<p>Our filtering conditions may be very specific, they can target different columns in the DataFrame, and they can be combined using the logical operator “&amp;” which means <strong>and</strong>:</p>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the data collected between 2000 and 2002 on female species?</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>surveys_df[(surveys_df.year <span class="op">&gt;=</span> <span class="dv">2000</span>) <span class="op">&amp;</span> (surveys_df.year <span class="op">&lt;=</span> <span class="dv">2002</span>) <span class="op">&amp;</span> (surveys_df.sex <span class="op">==</span> <span class="st">'F'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30158</td>
<td>30159</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>1</td>
<td>PP</td>
<td>F</td>
<td>22.0</td>
<td>17.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30160</td>
<td>30161</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>1</td>
<td>PP</td>
<td>F</td>
<td>21.0</td>
<td>17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30164</td>
<td>30165</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>1</td>
<td>PP</td>
<td>F</td>
<td>22.0</td>
<td>15.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30168</td>
<td>30169</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>2</td>
<td>PB</td>
<td>F</td>
<td>25.0</td>
<td>24.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30171</td>
<td>30172</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>2</td>
<td>NL</td>
<td>F</td>
<td>30.0</td>
<td>137.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35539</td>
<td>35540</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35540</td>
<td>35541</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>24.0</td>
<td>31.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35541</td>
<td>35542</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>26.0</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35542</td>
<td>35543</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>15</td>
<td>PB</td>
<td>F</td>
<td>27.0</td>
<td>34.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35546</td>
<td>35547</td>
<td>12</td>
<td>31</td>
<td>2002</td>
<td>10</td>
<td>RM</td>
<td>F</td>
<td>15.0</td>
<td>14.0</td>
</tr>
</tbody>
</table>

<p>2582 rows × 9 columns</p>
</div>
</div>
</div>
<p>We have also an operator for <strong>or</strong>. Below we filter for rows with collected data on female species in the year 2000 or 2002. “Give me all data where sex is Female and data is collected in 2000 or 2002”.</p>
<p>The method <code>isin()</code> allows to specify a range of “permitted” values for a certain column. Here it follows another example:</p>
<div class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>surveys_df[(surveys_df.year <span class="op">==</span> <span class="dv">2000</span>) <span class="op">&amp;</span> (surveys_df.sex <span class="op">==</span> <span class="st">'F'</span>) <span class="op">&amp;</span> (surveys_df.month.isin([<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>]))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">species_id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30158</td>
<td>30159</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>1</td>
<td>PP</td>
<td>F</td>
<td>22.0</td>
<td>17.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30160</td>
<td>30161</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>1</td>
<td>PP</td>
<td>F</td>
<td>21.0</td>
<td>17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30164</td>
<td>30165</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>1</td>
<td>PP</td>
<td>F</td>
<td>22.0</td>
<td>15.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30168</td>
<td>30169</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>2</td>
<td>PB</td>
<td>F</td>
<td>25.0</td>
<td>24.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30171</td>
<td>30172</td>
<td>1</td>
<td>8</td>
<td>2000</td>
<td>2</td>
<td>NL</td>
<td>F</td>
<td>30.0</td>
<td>137.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30637</td>
<td>30638</td>
<td>4</td>
<td>30</td>
<td>2000</td>
<td>20</td>
<td>PP</td>
<td>F</td>
<td>22.0</td>
<td>20.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30640</td>
<td>30641</td>
<td>4</td>
<td>30</td>
<td>2000</td>
<td>20</td>
<td>NL</td>
<td>F</td>
<td>30.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30645</td>
<td>30646</td>
<td>4</td>
<td>30</td>
<td>2000</td>
<td>24</td>
<td>PP</td>
<td>F</td>
<td>20.0</td>
<td>17.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30647</td>
<td>30648</td>
<td>4</td>
<td>30</td>
<td>2000</td>
<td>17</td>
<td>DM</td>
<td>F</td>
<td>36.0</td>
<td>46.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30648</td>
<td>30649</td>
<td>4</td>
<td>30</td>
<td>2000</td>
<td>17</td>
<td>DO</td>
<td>F</td>
<td>36.0</td>
<td>59.0</td>
</tr>
</tbody>
</table>

<p>156 rows × 9 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="dataframe-cleaning" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="dataframe-cleaning"><span class="header-section-number">7.4</span> DataFrame Cleaning</h2>
<p>A simple exploration of our DataFrame showed us that there are columns full of invalid values (NaN). One of the most important preliminary operations of data analysis is cleaning your data set, i.e.&nbsp;“getting rid” of non-numerical or non-character values. we want to make sure that our data only contains meaningful values.</p>
<p>Now that we mastered selecting, slicing, and subsetting, we can easily clean our DataFrame with few lines of code. Let us have a look at the function <em>isnull</em>. It is a Pandas function which we imported at the beginning with <code>import pandas as pd</code>. Now we can call the functin like this:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pd.isnull(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pd.isnull([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="st">''</span>, <span class="bu">dict</span>(), <span class="va">None</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([False, False, False, False, False,  True])</code></pre>
</div>
</div>
<p>We can pass single values or array-like values to the function. The function will then check for us whether each value is <code>NaN</code> (Not a Number) or <code>None</code> and return a boolean array. Note, that values like the empty string (a strin without any characters in it) or an empty dictionary etc will not count as <code>null</code> value, they do have a type, they only do not contain any values but they are something. <code>null</code> values in python are only <code>NaN</code> and <code>None</code>. When you read in tabular data into a DataFrame empty cells will be shown as <code>NaN</code>. <code>None</code> stands for the type <em>NoneType</em>, which we will not dive into further in this workshop.</p>
<p>With all that kowledge we can now detect <code>null</code> values in the column <em>weight</em> and do something about it. Let us have a look how many <code>null</code> values we can find:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Length of the full dataframe: "</span>, <span class="bu">len</span>(surveys_df))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pd.isnull(surveys_df.weight) <span class="co"># boolean array indicating where null values are found</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>surveys_df[pd.isnull(surveys_df.weight)] <span class="co"># all lines that have a null value in the column weight</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(surveys_df[pd.isnull(surveys_df.weight)]) <span class="co"># length</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Length of the full dataframe:  35549</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>3266</code></pre>
</div>
</div>
<p>As you can see, in our whole dataset 3266 weight values are not usable. We need to do something with those values.</p>
<p>Another thing that would not make sense are negative weights. Let’s check whether the remaining 32283 values in the <em>weight</em> column are positive:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(surveys_df[surveys_df.weight <span class="op">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>32283</code></pre>
</div>
</div>
<p>As we see, we have 32283 non-negative <em>weighht</em> values. The remaining 3266 values in the <em>weight</em> column are not set, so they are <code>null</code>. How can we impute the values? Let us have a look at the average weight:</p>
<div class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>surveys_df.weight.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>42.672428212991356</code></pre>
</div>
</div>
<p>A smooth run, without errors or warnings. As we said several times, Pandas is a library designed for data analysis and when performing data analysis it is very common to deal with not numeric values. In particular, the <code>.mean()</code> method has an argument called <em>skipna</em> that when set <code>True</code> (default value, so we do not need to specify it) excludes NaN values. This means that, in this case, Pandas simply ignores whatever it is not numeric and it performs computations only on numeric values.</p>
<p>If we are not happy with Pandas default behaviour, we can manually decide which value to assign to cells that contain <code>null</code> values. One possible choice is setting them to zero. To do that, we just need to apply the method <code>.fillna(&lt;value&gt;)</code>, where <code>&lt;value&gt;</code> is the number we want to substitute to the <code>null</code> value with (in our case, 0).</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cleaned_weight1 <span class="op">=</span> surveys_df.weight.fillna(<span class="dv">0</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>cleaned_weight_ave1 <span class="op">=</span> cleaned_weight1.mean()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cleaned_weight_ave1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>38.751976145601844</code></pre>
</div>
</div>
<p>You see that when filling the <code>null</code> values with 0, the average weight decreases. This is because the mean is now computed on data with many more zeros compared to the previous one. Conscious of this problem, we may now choose a more appropriate value to “fill” our <code>null</code> values. How about we use the “clean” mean of our first computation?</p>
<div class="cell" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cleaned_weight2 <span class="op">=</span> surveys_df.weight.fillna(surveys_df.weight.mean())</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cleaned_weight_ave2 <span class="op">=</span> cleaned_weight2.mean()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cleaned_weight_ave2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>42.672428212991356</code></pre>
</div>
</div>
<p>This time we obtain exactly the same result of our first computation, this is because we substituted the <code>null</code> values with a mean computed excluding the <code>null</code> values.</p>
<div class="alert alert-block alert-success">
<p><b>Exercise 6 and 7</b></p>
<p>Now go to the Jupyter Dashboard in your internet browser and continue with the afternoon exercises 6 and 7.</p>
</div></section>
<section id="grouping" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="grouping"><span class="header-section-number">7.5</span> Grouping</h2>
<p>We often want to calculate summary statistics grouped by subsets or attributes within fields of our data. For example, we might want to calculate the average weight of all individuals per site.</p>
<p>As we have seen above we can calculate basic statistics for all records in a single column using the syntax below:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>count    32283.000000
mean        42.672428
std         36.631259
min          4.000000
25%         20.000000
50%         37.000000
75%         48.000000
max        280.000000
Name: weight, dtype: float64</code></pre>
</div>
</div>
<p>If we want to summarize by one or more variables, for example sex, we can use Pandas’ <code>.groupby()</code> method. Once we’ve created a groupby DataFrame, we can quickly calculate summary statistics by a group of our choice.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> surveys_df.groupby(<span class="st">'sex'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>grouped_data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">record_id</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">hindfoot_length</th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">F</td>
<td>15690.0</td>
<td>18036.412046</td>
<td>10423.089000</td>
<td>3.0</td>
<td>8917.50</td>
<td>18075.5</td>
<td>27250.00</td>
<td>35547.0</td>
<td>15690.0</td>
<td>6.587253</td>
<td>...</td>
<td>36.0</td>
<td>64.0</td>
<td>15303.0</td>
<td>42.170555</td>
<td>36.847958</td>
<td>4.0</td>
<td>20.0</td>
<td>34.0</td>
<td>46.0</td>
<td>274.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">M</td>
<td>17348.0</td>
<td>17754.835601</td>
<td>10132.203323</td>
<td>1.0</td>
<td>8969.75</td>
<td>17727.5</td>
<td>26454.25</td>
<td>35548.0</td>
<td>17348.0</td>
<td>6.396184</td>
<td>...</td>
<td>36.0</td>
<td>58.0</td>
<td>16879.0</td>
<td>42.995379</td>
<td>36.184981</td>
<td>4.0</td>
<td>20.0</td>
<td>39.0</td>
<td>49.0</td>
<td>280.0</td>
</tr>
</tbody>
</table>

<p>2 rows × 56 columns</p>
</div>
</div>
</div>
<p>The output is a bit overwhelming. Let’s just have a look at one statistical value, the mean, to understand what is happening here:</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>grouped_data.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2316/1133710423.py:1: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  grouped_data.mean()</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">record_id</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th">hindfoot_length</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">F</td>
<td>18036.412046</td>
<td>6.587253</td>
<td>15.880943</td>
<td>1990.644997</td>
<td>11.440854</td>
<td>28.836780</td>
<td>42.170555</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">M</td>
<td>17754.835601</td>
<td>6.396184</td>
<td>16.078799</td>
<td>1990.480401</td>
<td>11.098282</td>
<td>29.709578</td>
<td>42.995379</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We see that the data is divided into two groups, one group where the value in the column <em>sex</em> equals “F” and another group where the value in the column <em>sex</em> equals “M”. The statistics is then calculated for all samples in that specific group for each of the columns in the dataframe. Note that samples annotated with sex equals NaN and column values with NaN are left out.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> surveys_df.groupby(...)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>grouped_data[...].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'ellipsis' object is not callable</code></pre>
</div>
</div>
</section>
<section id="structure-of-a-groupby-object" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="structure-of-a-groupby-object"><span class="header-section-number">7.6</span> Structure of a groupby object</h2>
<p>We can investigate which rows are assigned to which group as follows:</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(grouped_data.groups)) <span class="co"># dictionary</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Plot ids: "</span>, grouped_data.groups.keys()) <span class="co"># keys are the unique values of the column we grouped by</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Rows belonging to plot id "</span>, <span class="dv">1</span>, <span class="st">": "</span>, grouped_data.groups[<span class="dv">1</span>]) <span class="co"># values are row indexes </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.io.formats.printing.PrettyDict'&gt;
Plot ids:  dict_keys(['F', 'M'])</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>KeyError: 1</code></pre>
</div>
</div>
</section>
<section id="grouping-by-multiple-columns" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="grouping-by-multiple-columns"><span class="header-section-number">7.7</span> Grouping by multiple columns</h2>
<p>Now let’s have a look at a more complex grouping example. We want an overview statistics of the weight of all females and males by plot id. So in fact we want to group by <em>sex</em> and by <em>plot_id</em> at the same time.</p>
<p>This will give us exactly 48 groups for our survey data: - female, plot id = 1 - female, plot id = 2 - … - female, plot id = 24 - male, plot id = 1 - … - male, plot id = 24</p>
<p>Why 48 groups? We have 24 unique values for <em>plot_id</em>. Per plot we have two groups of samples, female and male. Hence, the grouping returns 48 groups.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> surveys_df.groupby([<span class="st">'sex'</span>, <span class="st">'plot_id'</span>])</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>grouped_data[<span class="st">"weight"</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">plot_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="24" data-quarto-table-cell-role="th" data-valign="top">F</td>
<td data-quarto-table-cell-role="th">1</td>
<td>826.0</td>
<td>46.311138</td>
<td>33.240958</td>
<td>5.0</td>
<td>26.00</td>
<td>40.0</td>
<td>50.00</td>
<td>196.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>954.0</td>
<td>52.561845</td>
<td>45.547697</td>
<td>5.0</td>
<td>25.00</td>
<td>40.0</td>
<td>51.00</td>
<td>274.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>873.0</td>
<td>31.215349</td>
<td>30.687451</td>
<td>4.0</td>
<td>15.00</td>
<td>23.0</td>
<td>34.00</td>
<td>199.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>850.0</td>
<td>46.818824</td>
<td>33.560664</td>
<td>5.0</td>
<td>28.00</td>
<td>40.0</td>
<td>47.00</td>
<td>200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>516.0</td>
<td>40.974806</td>
<td>36.396966</td>
<td>5.0</td>
<td>21.00</td>
<td>35.0</td>
<td>45.00</td>
<td>248.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>721.0</td>
<td>36.352288</td>
<td>29.513333</td>
<td>5.0</td>
<td>19.00</td>
<td>29.0</td>
<td>41.00</td>
<td>188.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>326.0</td>
<td>20.006135</td>
<td>17.895937</td>
<td>6.0</td>
<td>12.00</td>
<td>17.0</td>
<td>23.00</td>
<td>170.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>817.0</td>
<td>45.623011</td>
<td>31.045426</td>
<td>5.0</td>
<td>25.00</td>
<td>42.0</td>
<td>50.00</td>
<td>178.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>823.0</td>
<td>53.618469</td>
<td>35.572793</td>
<td>6.0</td>
<td>35.00</td>
<td>43.0</td>
<td>54.00</td>
<td>177.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>138.0</td>
<td>17.094203</td>
<td>14.074820</td>
<td>7.0</td>
<td>10.00</td>
<td>13.0</td>
<td>20.00</td>
<td>130.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>796.0</td>
<td>43.515075</td>
<td>29.627049</td>
<td>5.0</td>
<td>27.00</td>
<td>40.0</td>
<td>46.00</td>
<td>208.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>1040.0</td>
<td>49.831731</td>
<td>43.790247</td>
<td>6.0</td>
<td>26.00</td>
<td>41.0</td>
<td>48.25</td>
<td>264.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>610.0</td>
<td>40.524590</td>
<td>36.109806</td>
<td>5.0</td>
<td>21.00</td>
<td>31.0</td>
<td>42.00</td>
<td>192.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>692.0</td>
<td>47.355491</td>
<td>29.563455</td>
<td>5.0</td>
<td>37.00</td>
<td>43.0</td>
<td>48.00</td>
<td>211.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>467.0</td>
<td>26.670236</td>
<td>31.983137</td>
<td>4.0</td>
<td>12.50</td>
<td>18.0</td>
<td>26.00</td>
<td>198.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>211.0</td>
<td>25.810427</td>
<td>20.902314</td>
<td>4.0</td>
<td>13.00</td>
<td>21.0</td>
<td>31.00</td>
<td>158.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>874.0</td>
<td>48.176201</td>
<td>37.485528</td>
<td>6.0</td>
<td>27.00</td>
<td>41.0</td>
<td>49.00</td>
<td>192.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>740.0</td>
<td>36.963514</td>
<td>35.184417</td>
<td>5.0</td>
<td>17.00</td>
<td>28.5</td>
<td>40.00</td>
<td>212.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>514.0</td>
<td>21.978599</td>
<td>14.008822</td>
<td>6.0</td>
<td>12.00</td>
<td>20.0</td>
<td>29.00</td>
<td>139.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>631.0</td>
<td>52.624406</td>
<td>55.257665</td>
<td>5.0</td>
<td>17.00</td>
<td>30.0</td>
<td>48.00</td>
<td>220.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>596.0</td>
<td>25.974832</td>
<td>22.619863</td>
<td>4.0</td>
<td>11.00</td>
<td>24.0</td>
<td>31.00</td>
<td>188.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>646.0</td>
<td>53.647059</td>
<td>38.588538</td>
<td>5.0</td>
<td>29.00</td>
<td>39.0</td>
<td>54.00</td>
<td>161.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>163.0</td>
<td>20.564417</td>
<td>18.933945</td>
<td>8.0</td>
<td>12.00</td>
<td>16.0</td>
<td>23.00</td>
<td>199.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>479.0</td>
<td>47.914405</td>
<td>49.112574</td>
<td>6.0</td>
<td>21.00</td>
<td>33.0</td>
<td>44.00</td>
<td>251.0</td>
</tr>
<tr class="odd">
<td rowspan="24" data-quarto-table-cell-role="th" data-valign="top">M</td>
<td data-quarto-table-cell-role="th">1</td>
<td>1072.0</td>
<td>55.950560</td>
<td>41.035686</td>
<td>4.0</td>
<td>37.00</td>
<td>46.0</td>
<td>54.00</td>
<td>231.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>1114.0</td>
<td>51.391382</td>
<td>46.690887</td>
<td>5.0</td>
<td>24.00</td>
<td>42.0</td>
<td>50.00</td>
<td>278.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>827.0</td>
<td>34.163241</td>
<td>40.260426</td>
<td>5.0</td>
<td>13.00</td>
<td>23.0</td>
<td>39.00</td>
<td>250.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>1010.0</td>
<td>48.888119</td>
<td>32.254168</td>
<td>4.0</td>
<td>32.00</td>
<td>44.5</td>
<td>50.00</td>
<td>187.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>573.0</td>
<td>40.708551</td>
<td>31.250967</td>
<td>6.0</td>
<td>21.00</td>
<td>40.0</td>
<td>49.00</td>
<td>240.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>739.0</td>
<td>36.867388</td>
<td>30.867779</td>
<td>6.0</td>
<td>18.00</td>
<td>31.0</td>
<td>46.00</td>
<td>241.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>303.0</td>
<td>21.194719</td>
<td>23.971252</td>
<td>4.0</td>
<td>11.00</td>
<td>17.0</td>
<td>23.00</td>
<td>235.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>962.0</td>
<td>49.641372</td>
<td>34.820355</td>
<td>5.0</td>
<td>29.00</td>
<td>45.0</td>
<td>52.00</td>
<td>173.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>984.0</td>
<td>49.519309</td>
<td>31.888023</td>
<td>6.0</td>
<td>37.00</td>
<td>46.0</td>
<td>50.00</td>
<td>275.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>139.0</td>
<td>19.971223</td>
<td>25.061068</td>
<td>4.0</td>
<td>10.00</td>
<td>12.0</td>
<td>22.00</td>
<td>237.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>994.0</td>
<td>43.366197</td>
<td>28.425105</td>
<td>6.0</td>
<td>25.00</td>
<td>43.0</td>
<td>49.00</td>
<td>212.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>1174.0</td>
<td>48.909710</td>
<td>39.301038</td>
<td>7.0</td>
<td>25.25</td>
<td>43.0</td>
<td>50.00</td>
<td>280.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>757.0</td>
<td>40.097754</td>
<td>31.753448</td>
<td>6.0</td>
<td>20.00</td>
<td>34.0</td>
<td>47.00</td>
<td>241.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>1029.0</td>
<td>45.159378</td>
<td>25.272173</td>
<td>5.0</td>
<td>35.00</td>
<td>44.0</td>
<td>50.00</td>
<td>222.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>401.0</td>
<td>27.523691</td>
<td>38.631271</td>
<td>4.0</td>
<td>10.00</td>
<td>18.0</td>
<td>25.00</td>
<td>259.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>265.0</td>
<td>23.811321</td>
<td>14.663726</td>
<td>5.0</td>
<td>11.00</td>
<td>20.0</td>
<td>35.00</td>
<td>61.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>1011.0</td>
<td>47.558853</td>
<td>34.082010</td>
<td>4.0</td>
<td>27.00</td>
<td>45.0</td>
<td>51.00</td>
<td>216.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>607.0</td>
<td>43.546952</td>
<td>41.864279</td>
<td>7.0</td>
<td>18.00</td>
<td>33.0</td>
<td>48.00</td>
<td>256.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>567.0</td>
<td>20.306878</td>
<td>12.553954</td>
<td>4.0</td>
<td>10.00</td>
<td>19.0</td>
<td>25.00</td>
<td>100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>588.0</td>
<td>44.197279</td>
<td>43.361503</td>
<td>5.0</td>
<td>17.00</td>
<td>34.0</td>
<td>47.00</td>
<td>223.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>431.0</td>
<td>22.772622</td>
<td>18.984554</td>
<td>4.0</td>
<td>9.00</td>
<td>19.0</td>
<td>32.00</td>
<td>190.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>648.0</td>
<td>54.572531</td>
<td>38.841066</td>
<td>6.0</td>
<td>31.00</td>
<td>44.0</td>
<td>53.00</td>
<td>212.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>205.0</td>
<td>18.941463</td>
<td>17.979740</td>
<td>4.0</td>
<td>10.00</td>
<td>12.0</td>
<td>22.00</td>
<td>131.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>479.0</td>
<td>39.321503</td>
<td>42.003947</td>
<td>4.0</td>
<td>17.00</td>
<td>24.0</td>
<td>45.00</td>
<td>230.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="counting-and-plotting" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="counting-and-plotting"><span class="header-section-number">7.8</span> Counting and plotting</h2>
<p>Another very useful outcome of grouping is the possibility of performing selective counting. For example, let’s see how to count the number of records per species. We just need to remember that each species has a unique ID and that records are identified by another ID stored in the column record ID. We will first group our data according to the species ID and then, for each group, we will count the number of records. Several consecutive operations that, once again, Pandas allows us to execute in a single line.</p>
<div class="cell" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>species_counts <span class="op">=</span> surveys_df.groupby(<span class="st">'species_id'</span>)[<span class="st">'record_id'</span>].count()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(grouped_species_counts))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>species_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'grouped_species_counts' is not defined</code></pre>
</div>
</div>
<p>We can also plot the information for better overview. We will learn more about plotting after the next chapter.</p>
<div class="cell" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>species_counts.plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;AxesSubplot: xlabel='species_id'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="data-science-with-pandas-2_files/figure-html/cell-36-output-2.png" width="593" height="438"></p>
</div>
</div>
</section>
<section id="summary-grouping" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="summary-grouping"><span class="header-section-number">7.9</span> Summary grouping</h2>
<p>Grouping is one of the most common operation in data analysis. Data often consists of different measurements on the same samples. In many cases we are not only interested in one particular measurement but in the cross product of measurements. In the picture below we labeled samples with green lines, blue dots and red lines. We are now interested how these three different groups relate to each other given the all other measurements in the dataframe. Pandas’ groupby function gives us the means to compare these three groups with several built-in statistical methods.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/grouping.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Grouping sketch</figcaption>
</figure>
</div>
<div class="alert alert-block alert-success">
<p><b>Exercise 8 to 10</b></p>
<p>Now go to the Jupyter Dashboard in your internet browser and continue with the afternoon exercises 8 to 10.</p>
<p>After you finished the exercises please come back to this document and continue with the <a href="./data-science-with-pandas-3.html">following chapter</a>.</p>


</div></section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data-science-with-pandas-1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reading and Exploring data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data-science-with-pandas-3.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Combining DataFrames</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>